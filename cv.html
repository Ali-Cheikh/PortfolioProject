<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Resume Builder Pro</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        @media print {
            body { 
                margin: 0;
                background: white !important;
            }
            .no-print { display: none !important; }
            .resume-container { margin-left: 0 !important; }
            #resume-content { 
                box-shadow: none !important;
                padding: 0.5in !important;
                max-width: 100% !important;
            }
            input, textarea { 
                border: none !important; 
                outline: none !important;
                background: transparent !important;
            }
            button { display: none !important; }
        }
        
        input:focus, textarea:focus {
            outline: 2px solid #3b82f6;
            outline-offset: 2px;
        }

        .editable-input {
            background: transparent;
            border: 0;
            outline: none;
            width: 100%;
        }

        .editable-input:focus {
            outline: 2px solid #3b82f6;
            outline-offset: 2px;
            border-radius: 4px;
            padding: 0 8px;
        }
    </style>
</head>
<body class="min-h-screen bg-gray-100">
    <!-- Top Controls -->
    <div id="topBar" class="no-print fixed top-0 left-0 right-0 z-50 bg-white border-b border-gray-200 px-6 py-3 flex items-center justify-between shadow-sm">
        <h1 class="text-xl font-bold text-gray-900">Resume Builder Pro</h1>
        <div class="flex gap-2">
            <button onclick="toggleEditMode()" id="editModeBtn" class="flex items-center gap-2 px-4 py-2 rounded-lg bg-green-500 hover:bg-green-600 text-white transition-colors">
                <i class="fas fa-edit"></i> Preview Mode
            </button>
            <button onclick="saveResume()" class="flex items-center gap-2 px-4 py-2 rounded-lg bg-blue-500 hover:bg-blue-600 text-white transition-colors">
                <i class="fas fa-save"></i> Save
            </button>
            <button onclick="loadResume()" class="flex items-center gap-2 px-4 py-2 rounded-lg bg-green-500 hover:bg-green-600 text-white transition-colors">
                <i class="fas fa-upload"></i> Load
            </button>
            <button onclick="downloadPDF()" class="flex items-center gap-2 px-4 py-2 rounded-lg bg-purple-500 hover:bg-purple-600 text-white transition-colors">
                <i class="fas fa-download"></i> Download PDF
            </button>
            <button onclick="toggleTheme()" id="themeBtn" class="flex items-center gap-2 px-4 py-2 rounded-lg bg-gray-200 hover:bg-gray-300 text-gray-900 transition-colors">
                <i class="fas fa-moon"></i>
            </button>
        </div>
    </div>

    <div class="flex pt-16">
        <!-- Sidebar -->
        <div id="sidebar" class="no-print fixed left-0 top-16 bottom-0 w-72 bg-white border-r border-gray-200 p-4 overflow-y-auto">
            <div class="mb-6">
                <h2 class="text-xs font-bold mb-3 text-gray-500 uppercase tracking-wider">Left Column Components</h2>
                <div class="space-y-2">
                    <button onclick="addSection('sectionHeading', 'left')" class="w-full text-left px-3 py-2.5 rounded-lg bg-gray-50 hover:bg-gray-100 text-gray-900 transition-colors flex items-center gap-2 text-sm">
                        <i class="fas fa-plus text-xs"></i> üìã Section Heading
                    </button>
                    <button onclick="addSection('job', 'left')" class="w-full text-left px-3 py-2.5 rounded-lg bg-gray-50 hover:bg-gray-100 text-gray-900 transition-colors flex items-center gap-2 text-sm">
                        <i class="fas fa-plus text-xs"></i> üíº Job Experience
                    </button>
                    <button onclick="addSection('education', 'left')" class="w-full text-left px-3 py-2.5 rounded-lg bg-gray-50 hover:bg-gray-100 text-gray-900 transition-colors flex items-center gap-2 text-sm">
                        <i class="fas fa-plus text-xs"></i> üéì Education
                    </button>
                </div>
            </div>

            <div>
                <h2 class="text-xs font-bold mb-3 text-gray-500 uppercase tracking-wider">Right Column Components</h2>
                <div class="space-y-2">
                    <button onclick="addSection('sectionHeading', 'right')" class="w-full text-left px-3 py-2.5 rounded-lg bg-gray-50 hover:bg-gray-100 text-gray-900 transition-colors flex items-center gap-2 text-sm">
                        <i class="fas fa-plus text-xs"></i> üìã Section Heading
                    </button>
                    <button onclick="addSection('skillCategory', 'right')" class="w-full text-left px-3 py-2.5 rounded-lg bg-gray-50 hover:bg-gray-100 text-gray-900 transition-colors flex items-center gap-2 text-sm">
                        <i class="fas fa-plus text-xs"></i> ‚ö° Skill Category
                    </button>
                    <button onclick="addSection('project', 'right')" class="w-full text-left px-3 py-2.5 rounded-lg bg-gray-50 hover:bg-gray-100 text-gray-900 transition-colors flex items-center gap-2 text-sm">
                        <i class="fas fa-plus text-xs"></i> üìä Project
                    </button>
                    <button onclick="addSection('languages', 'right')" class="w-full text-left px-3 py-2.5 rounded-lg bg-gray-50 hover:bg-gray-100 text-gray-900 transition-colors flex items-center gap-2 text-sm">
                        <i class="fas fa-plus text-xs"></i> üåç Languages
                    </button>
                </div>
            </div>

            <div class="mt-6 p-3 rounded-lg bg-blue-50 text-xs">
                <p class="text-gray-700">
                    <strong>üí° Tips:</strong><br>
                    ‚Ä¢ Click text to edit<br>
                    ‚Ä¢ Use arrows to reorder<br>
                    ‚Ä¢ Click trash to delete<br>
                    ‚Ä¢ Toggle Preview Mode to see final output
                </p>
            </div>
        </div>

        <!-- Main Resume Area -->
        <div id="resumeContainer" class="resume-container ml-72 flex-1 p-8">
            <div class="max-w-[850px] mx-auto">
                <div id="resume-content" class="bg-white shadow-2xl p-12" style="font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; font-size: 13px; line-height: 1.5;">
                    <!-- Header -->
                    <header class="text-center mb-6 pb-6 border-b-2 border-gray-800">
                        <input id="name" type="text" value="Ali Cheikh" class="editable-input text-3xl font-bold mb-2 text-center" placeholder="Your Name">
                        <input id="subtitle" type="text" value="Tunisian Entrepreneur | Community Innovator | Sustainable Tech Builder" class="editable-input text-sm mb-4 text-center" placeholder="Your Subtitle">
                        
                        <div class="flex justify-center gap-6 text-xs text-gray-700 flex-wrap">
                            <span>‚úâÔ∏è <input id="email" type="email" value="contact@ali-cheikh.com" class="editable-input inline w-40" placeholder="email@example.com"></span>
                            <span>üì± <input id="phone" type="tel" value="+216 90 725 434" class="editable-input inline w-32" placeholder="+1 234 567 890"></span>
                            <span>üåê <input id="website" type="text" value="ali-cheikh.com" class="editable-input inline w-32" placeholder="website.com"></span>
                            <span>üíº <input id="linkedin" type="text" value="LinkedIn" class="editable-input inline w-24" placeholder="LinkedIn"></span>
                        </div>
                    </header>

                    <!-- Summary -->
                    <div class="mb-6">
                        <textarea id="summary" class="editable-input text-sm resize-none w-full" rows="3" placeholder="Write your professional summary...">Tunisian entrepreneur and developer building practical tech solutions for community impact. Selected for Live The Residency ‚Äì Delta (top 15 of 1,500 applicants). Co-founded BlooLabb, an AI-powered learning platform for Tunisian youth. Experienced in creating sustainable solutions for local businesses and education initiatives across Tunisia.</textarea>
                    </div>

                    <!-- Two Column Layout -->
                    <div class="grid grid-cols-2 gap-8">
                        <!-- Left Column -->
                        <div id="leftColumn">
                            <div class="text-center py-8 text-gray-400 text-sm">
                                Add sections from sidebar
                            </div>
                        </div>

                        <!-- Right Column -->
                        <div id="rightColumn">
                            <div class="text-center py-8 text-gray-400 text-sm">
                                Add sections from sidebar
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let editMode = true;
        let theme = 'light';
        let resumeData = {
            leftSections: [],
            rightSections: []
        };

        function toggleEditMode() {
            editMode = !editMode;
            const btn = document.getElementById('editModeBtn');
            const sidebar = document.getElementById('sidebar');
            const container = document.getElementById('resumeContainer');
            
            if (editMode) {
                btn.innerHTML = '<i class="fas fa-edit"></i> Preview Mode';
                btn.className = 'flex items-center gap-2 px-4 py-2 rounded-lg bg-green-500 hover:bg-green-600 text-white transition-colors';
                sidebar.style.display = 'block';
                container.classList.add('ml-72');
            } else {
                btn.innerHTML = '<i class="fas fa-edit"></i> Edit Mode';
                btn.className = 'flex items-center gap-2 px-4 py-2 rounded-lg bg-gray-500 hover:bg-gray-600 text-white transition-colors';
                sidebar.style.display = 'none';
                container.classList.remove('ml-72');
            }
            renderResume();
        }

        function toggleTheme() {
            theme = theme === 'light' ? 'dark' : 'light';
            const btn = document.getElementById('themeBtn');
            if (theme === 'dark') {
                document.body.classList.add('bg-gray-900');
                document.body.classList.remove('bg-gray-100');
                btn.innerHTML = '<i class="fas fa-sun"></i>';
            } else {
                document.body.classList.add('bg-gray-100');
                document.body.classList.remove('bg-gray-900');
                btn.innerHTML = '<i class="fas fa-moon"></i>';
            }
        }

        function downloadPDF() {
            const originalEditMode = editMode;
            if (editMode) {
                editMode = false;
                renderResume();
            }
            setTimeout(() => {
                window.print();
                setTimeout(() => {
                    if (originalEditMode) {
                        editMode = true;
                        renderResume();
                    }
                }, 500);
            }, 300);
        }

        function saveResume() {
            const data = {
                name: document.getElementById('name').value,
                subtitle: document.getElementById('subtitle').value,
                email: document.getElementById('email').value,
                phone: document.getElementById('phone').value,
                website: document.getElementById('website').value,
                linkedin: document.getElementById('linkedin').value,
                summary: document.getElementById('summary').value,
                leftSections: resumeData.leftSections,
                rightSections: resumeData.rightSections
            };
            localStorage.setItem('resumeData', JSON.stringify(data));
            alert('‚úÖ Resume saved!');
        }

        function loadResume() {
            const saved = localStorage.getItem('resumeData');
            if (saved) {
                const data = JSON.parse(saved);
                document.getElementById('name').value = data.name || '';
                document.getElementById('subtitle').value = data.subtitle || '';
                document.getElementById('email').value = data.email || '';
                document.getElementById('phone').value = data.phone || '';
                document.getElementById('website').value = data.website || '';
                document.getElementById('linkedin').value = data.linkedin || '';
                document.getElementById('summary').value = data.summary || '';
                resumeData.leftSections = data.leftSections || [];
                resumeData.rightSections = data.rightSections || [];
                renderResume();
                alert('‚úÖ Resume loaded!');
            } else {
                alert('No saved resume found!');
            }
        }

        function addSection(type, column) {
            const templates = {
                sectionHeading: {
                    type: 'sectionHeading',
                    id: Date.now(),
                    icon: 'üíº',
                    title: 'Section Title'
                },
                job: {
                    type: 'job',
                    id: Date.now(),
                    title: 'Job Title',
                    company: 'Company Name',
                    date: '2024 ‚Äì Present',
                    bullets: ['Key achievement or responsibility']
                },
                education: {
                    type: 'education',
                    id: Date.now(),
                    institution: 'School Name',
                    degree: 'Degree Name',
                    date: '2024'
                },
                project: {
                    type: 'project',
                    id: Date.now(),
                    title: 'Project Name',
                    date: '2024',
                    description: 'Project description goes here'
                },
                skillCategory: {
                    type: 'skillCategory',
                    id: Date.now(),
                    category: 'Category',
                    skills: 'Skill 1, Skill 2, Skill 3'
                },
                languages: {
                    type: 'languages',
                    id: Date.now(),
                    languages: [
                        { name: 'English', level: 'Professional' },
                        { name: 'Arabic', level: 'Native' }
                    ]
                }
            };

            const targetArray = column === 'left' ? 'leftSections' : 'rightSections';
            resumeData[targetArray].push(templates[type]);
            renderResume();
        }

        function deleteSection(column, id) {
            const targetArray = column === 'left' ? 'leftSections' : 'rightSections';
            resumeData[targetArray] = resumeData[targetArray].filter(s => s.id !== id);
            renderResume();
        }

        function moveSection(column, id, direction) {
            const targetArray = column === 'left' ? 'leftSections' : 'rightSections';
            const sections = resumeData[targetArray];
            const index = sections.findIndex(s => s.id === id);
            
            if ((direction === 'up' && index === 0) || (direction === 'down' && index === sections.length - 1)) {
                return;
            }
            
            const newIndex = direction === 'up' ? index - 1 : index + 1;
            [sections[index], sections[newIndex]] = [sections[newIndex], sections[index]];
            renderResume();
        }

        function updateSectionField(column, id, field, value) {
            const targetArray = column === 'left' ? 'leftSections' : 'rightSections';
            const section = resumeData[targetArray].find(s => s.id === id);
            if (section) {
                section[field] = value;
            }
        }

        function addBullet(column, id) {
            const targetArray = column === 'left' ? 'leftSections' : 'rightSections';
            const section = resumeData[targetArray].find(s => s.id === id);
            if (section && section.bullets) {
                section.bullets.push('New bullet point');
                renderResume();
            }
        }

        function updateBullet(column, id, index, value) {
            const targetArray = column === 'left' ? 'leftSections' : 'rightSections';
            const section = resumeData[targetArray].find(s => s.id === id);
            if (section && section.bullets) {
                section.bullets[index] = value;
            }
        }

        function renderSection(section, column, index) {
            const isEditing = editMode;
            let html = `<div class="relative group ${isEditing ? 'hover:bg-gray-50 rounded-lg p-2 -mx-2' : ''} mb-6">`;
            
            if (isEditing) {
                html += `
                    <div class="absolute -left-10 top-2 opacity-0 group-hover:opacity-100 transition-opacity flex flex-col gap-1">
                        <button onclick="moveSection('${column}', ${section.id}, 'up')" class="p-1 rounded hover:bg-gray-200 text-gray-600">
                            <i class="fas fa-chevron-up text-xs"></i>
                        </button>
                        <button onclick="moveSection('${column}', ${section.id}, 'down')" class="p-1 rounded hover:bg-gray-200 text-gray-600">
                            <i class="fas fa-chevron-down text-xs"></i>
                        </button>
                    </div>
                    <button onclick="deleteSection('${column}', ${section.id})" class="absolute -right-2 -top-1 opacity-0 group-hover:opacity-100 transition-opacity p-1.5 rounded hover:bg-red-100 text-red-500">
                        <i class="fas fa-trash text-xs"></i>
                    </button>
                `;
            }

            if (section.type === 'sectionHeading') {
                html += `
                    <div class="mb-4 pb-2 border-b-2 border-gray-800">
                        <h2 class="text-lg font-bold flex items-center gap-2">
                            ${isEditing ? `
                                <input type="text" value="${section.icon}" onchange="updateSectionField('${column}', ${section.id}, 'icon', this.value)" class="w-8 bg-transparent border-0 outline-none focus:ring-2 focus:ring-blue-500 rounded px-1">
                                <input type="text" value="${section.title}" onchange="updateSectionField('${column}', ${section.id}, 'title', this.value)" class="flex-1 bg-transparent border-0 outline-none focus:ring-2 focus:ring-blue-500 rounded px-2">
                            ` : `
                                <span>${section.icon}</span>
                                <span>${section.title}</span>
                            `}
                        </h2>
                    </div>
                `;
            }

            if (section.type === 'job') {
                html += `
                    <div class="mb-5">
                        <div class="flex justify-between items-start mb-2">
                            <div class="flex-1">
                                ${isEditing ? `
                                    <input type="text" value="${section.title}" onchange="updateSectionField('${column}', ${section.id}, 'title', this.value)" class="font-bold text-base w-full bg-transparent border-0 outline-none focus:ring-2 focus:ring-blue-500 rounded px-2">
                                    <input type="text" value="${section.company}" onchange="updateSectionField('${column}', ${section.id}, 'company', this.value)" class="text-sm w-full bg-transparent border-0 outline-none focus:ring-2 focus:ring-blue-500 rounded px-2">
                                ` : `
                                    <div class="font-bold text-base">${section.title}</div>
                                    <div class="text-sm text-gray-700">${section.company}</div>
                                `}
                            </div>
                            ${isEditing ? `
                                <input type="text" value="${section.date}" onchange="updateSectionField('${column}', ${section.id}, 'date', this.value)" class="text-sm text-right text-gray-600 bg-transparent border-0 outline-none focus:ring-2 focus:ring-blue-500 rounded px-2 ml-4 w-40">
                            ` : `
                                <div class="text-sm text-gray-600 ml-4 whitespace-nowrap">${section.date}</div>
                            `}
                        </div>
                        <ul class="list-disc list-inside space-y-1 text-sm">
                            ${section.bullets.map((bullet, i) => `
                                <li class="text-gray-700">
                                    ${isEditing ? `
                                        <input type="text" value="${bullet}" onchange="updateBullet('${column}', ${section.id}, ${i}, this.value)" class="w-[95%] bg-transparent border-0 outline-none focus:ring-2 focus:ring-blue-500 rounded px-2 -ml-1">
                                    ` : `
                                        <span>${bullet}</span>
                                    `}
                                </li>
                            `).join('')}
                        </ul>
                        ${isEditing ? `
                            <button onclick="addBullet('${column}', ${section.id})" class="text-xs text-blue-600 hover:text-blue-700 ml-6 mt-1">
                                + Add bullet
                            </button>
                        ` : ''}
                    </div>
                `;
            }

            if (section.type === 'education') {
                html += `
                    <div class="mb-4">
                        <div class="flex justify-between items-start">
                            <div class="flex-1">
                                ${isEditing ? `
                                    <input type="text" value="${section.institution}" onchange="updateSectionField('${column}', ${section.id}, 'institution', this.value)" class="font-bold text-sm w-full bg-transparent border-0 outline-none focus:ring-2 focus:ring-blue-500 rounded px-2">
                                    <input type="text" value="${section.degree}" onchange="updateSectionField('${column}', ${section.id}, 'degree', this.value)" class="text-sm w-full bg-transparent border-0 outline-none focus:ring-2 focus:ring-blue-500 rounded px-2">
                                ` : `
                                    <div class="font-bold text-sm">${section.institution}</div>
                                    <div class="text-sm text-gray-700">${section.degree}</div>
                                `}
                            </div>
                            ${isEditing ? `
                                <input type="text" value="${section.date}" onchange="updateSectionField('${column}', ${section.id}, 'date', this.value)" class="text-sm text-right text-gray-600 bg-transparent border-0 outline-none focus:ring-2 focus:ring-blue-500 rounded px-2 ml-4">
                            ` : `
                                <div class="text-sm text-gray-600 ml-4 whitespace-nowrap">${section.date}</div>
                            `}
                        </div>
                    </div>
                `;
            }

            if (section.type === 'project') {
                html += `
                    <div class="mb-4">
                        <div class="flex justify-between items-start mb-1">
                            ${isEditing ? `
                                <input type="text" value="${section.title}" onchange="updateSectionField('${column}', ${section.id}, 'title', this.value)" class="font-bold text-sm flex-1 bg-transparent border-0 outline-none focus:ring-2 focus:ring-blue-500 rounded px-2">
                                <input type="text" value="${section.date}" onchange="updateSectionField('${column}', ${section.id}, 'date', this.value)" class="text-sm text-right text-gray-600 bg-transparent border-0 outline-none focus:ring-2 focus:ring-blue-500 rounded px-2 ml-4">
                            ` : `
                                <div class="font-bold text-sm flex-1">${section.title}</div>
                                <div class="text-sm text-gray-600 ml-4 whitespace-nowrap">${section.date}</div>
                            `}
                        </div>
                        ${isEditing ? `
                            <textarea onchange="updateSectionField('${column}', ${section.id}, 'description', this.value)" class="text-sm w-full bg-transparent border-0 outline-none focus:ring-2 focus:ring-blue-500 rounded px-2 resize-none text-gray-700" rows="2">${section.description}</textarea>
                        ` : `
                            <div class="text-sm text-gray-700">${section.description}</div>
                        `}
                    </div>
                `;
            }

            if (section.type === 'skillCategory') {
                html += `
                    <div class="mb-3">
                        ${isEditing ? `
                            <input type="text" value="${section.category}" onchange="updateSectionField('${column}', ${section.id}, 'category', this.value)" class="font-bold text-sm w-full bg-transparent border-0 outline-none focus:ring-2 focus:ring-blue-500 rounded px-2 mb-1">
                            <input type="text" value="${section.skills}" onchange="updateSectionField('${column}', ${section.id}, 'skills', this.value)" class="text-sm w-full bg-transparent border-0 outline-none focus:ring-2 focus:ring-blue-500 rounded px-2 text-gray-700">
                        ` : `
                            <div class="text-sm">
                                <span class="font-bold">${section.category}:</span> 
                                <span class="text-gray-700">${section.skills}</span>
                            </div>
                        `}
                    </div>
                `;
            }

            if (section.type === 'languages') {
                html += `
                    <div>
                        <div class="grid grid-cols-3 gap-4">
                            ${section.languages.map((lang, i) => `
                                <div class="text-center">
                                    ${isEditing ? `
                                        <input type="text" value="${lang.name}" onchange="updateSectionField('${column}', ${section.id}, 'languages', [...${JSON.stringify(section.languages).slice(0, -1)}, {...${JSON.stringify(section.languages)}[${i}], name: this.value}])" class="font-bold text-sm w-full bg-transparent border-0 outline-none focus:ring-2 focus:ring-blue-500 rounded px-2 text-center">
                                        <input type="text" value="${lang.level}" class="text-xs text-gray-600 w-full bg-transparent border-0 outline-none focus:ring-2 focus:ring-blue-500 rounded px-2 text-center">
                                    ` : `
                                        <div class="font-bold text-sm">${lang.name}</div>
                                        <div class="text-xs text-gray-600">${lang.level}</div>
                                    `}
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
            }

            html += '</div>';
            return html;
        }

        function renderResume() {
            const leftColumn = document.getElementById('leftColumn');
            const rightColumn = document.getElementById('rightColumn');

            if (resumeData.leftSections.length === 0) {
                leftColumn.innerHTML = editMode ? '<div class="text-center py-8 text-gray-400 text-sm">Add sections from sidebar</div>' : '';
            } else {
                leftColumn.innerHTML = resumeData.leftSections.map((section, idx) => renderSection(section, 'left', idx)).join('');
            }

            if (resumeData.rightSections.length === 0) {
                rightColumn.innerHTML = editMode ? '<div class="text-center py-8 text-gray-400 text-sm">Add sections from sidebar</div>' : '';
            } else {
                rightColumn.innerHTML = resumeData.rightSections.map((section, idx) => renderSection(section, 'right', idx)).join('');
            }
        }

        // Initial render
        renderResume();
    </script>
</body>
</html>